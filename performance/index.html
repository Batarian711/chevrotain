<!DOCTYPE html>
<html>
<head lang="en">
    <link rel="stylesheet" type="text/css" href="style.css">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<script src="libs/lodash.js"></script>
<script src="libs/benchmark.js"></script>
<script src="libs/chevrotain.js"></script>
<script src="samples/10K_json.js"></script>

<script src="jsonParsers/chevrotain/jisonLexer.js"></script>
<script src="jsonParsers/chevrotain/chevrotainParser.js"></script>
<script src="jsonParsers/chevrotain/json_handbuilt_lexer.js"></script>
<script src="jsonParsers/chevrotain/api.js"></script>

<script src="jsonParsers/jison/jisonParser.js"></script>

<script src="jsonParsers/pegjs/pegjs_jison_parser.js"></script>
<table id="resultsTable">
    <tr>
        <td style="font-weight: bold">Parser Generator Configuration</td>
        <td style="font-weight: bold">ops/second</td>
        <td style="font-weight: bold">Number of Iterations</td>
    </tr>
</table>
<p id="fastestInResults"></p>
<script>

    var suite = new Benchmark.Suite;
    suite.add('Jison Generated Parser + lexer', function() {
        jisonJsonLexerAndParser.parse(json_sample10k)
    }).add('Chevrotain With Jison Generated Lexer', function() {
        chevrotainParseWithJisonLexer(json_sample10k)
    }).add('Chevrotain With hand built Lexer', function() {
        chevrotainParseWithHandBuiltLexer(json_sample10k)
    }).add('pegjs generated parser + lexer', function() {
        pegjsJsonLexerAndParser.parse(json_sample10k)
    }).on('cycle', function(event) {
        console.log(String(event.target));
        // Find a <table> element with id="resultsTable":
        var table = document.getElementById("resultsTable");

        // Create an empty <tr> element and add it to the 1st position of the table:
        var row = table.insertRow(-1);

        // Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);

        // Add some text to the new cells:
        cell1.innerHTML = event.target.name;
        cell2.innerHTML = event.target.hz.toFixed(2) + "    " + "\xB1" + event.target.stats.rme.toFixed(2) + "%";
        cell3.innerHTML = event.target.stats.sample.length + " samples ran";
    }).on('complete', function() {
        var sFastest = 'Fastest is ' + this.filter('fastest').pluck('name');
        console.log(sFastest);
        document.getElementById("fastestInResults").innerHTML = sFastest;
    }).run({'async': true});

</script>
</body>
</html>
<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <!-- Style Sheets -->
    <link rel="stylesheet" type="text/css" href="CSS/playground.css">
    <link rel="stylesheet" type="text/css" href="CSS/railroad-diagrams.css">
    <!-- Libraries -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.9.3/lodash.min.js"></script>
    <script src="RailRoadDiagreams/railroad-diagrams.js"></script>
    <script src="chevtorain_temp.js"></script>
    <script src="syntaxBuilding.js"></script>
    <title>Playground</title>
</head>
<body style="background-color: #f1f1f1">

<div align="center">
    <div class="leftPart">
        <div class="card">
            <div align="center">
                <h1>Parser Code</h1>
            </div>

            <div class="textareawrapper">
            <textarea class="textArea" id="parserCodeAreaID" rows="25" cols="100" autocomplete="off" autocorrect="off"
                      autocapitalize="off" spellcheck="false"></textarea>
            </div>
        </div>
        <div class="card">
            <div align="center">
                <h1>Try Your Parser</h1>
            </div>
            <div class="textareawrapper">
            <textarea class="textArea" rows="25" cols="100" autocomplete="off" autocorrect="off" autocapitalize="off"
                      spellcheck="false" placeholder="Coming Soon!!"></textarea>
            </div>
        </div>
    </div>
    <div class="rightPart">
        <div class="card">
            <div align="center">
                <h1 style="float: left">Syntax Diagrams</h1>
                <button id="refreshSyntaxDiagrams" style="float: left;margin-top: 16px;margin-left: 12px;">Refresh
                </button>
            </div>
            <div style="clear:both;"></div>
            <div id="svgWrapperId" class="svgWrapper"></div>
        </div>
    </div>
    <div style="clear:both;"></div>
</div>


<script>
    $(document).ready(function () {
        $.ajax({
            url: "DefaultParserCodeValue.txt",
            dataType: "text",
            success: function (data) {
                $("#parserCodeAreaID").text(data);

                function addSvgDiagrams() {
                    var svgWrapperDiv = document.getElementById("svgWrapperId");
                    svgWrapperDiv.innerHTML = "";
                    var parserConstructor = eval($("#parserCodeAreaID").val());
                    var parser = new parserConstructor();
                    var topLevels = parser.getGAstProductions().values();
                    _.forEach(topLevels, function (production) {
                        var svg = convertProductionToDiagram(production);
                        document.getElementById("svgWrapperId").innerHTML += svg;
                    })
                }

                addSvgDiagrams();

                $("#refreshSyntaxDiagrams").click(function () {
                    console.log("Refreshing the diagrams");
                    addSvgDiagrams();
                });
            }
        });

    });
</script>

</body>
</html>

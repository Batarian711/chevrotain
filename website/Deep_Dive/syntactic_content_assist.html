<!DOCTYPE html>
<!--[if lt IE 7]>       <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>          <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>          <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>syntactic content assist - Chevrotain</title>
    <meta name="description" content="JavaScript Parser Building Toolkit" />
    <meta name="author" content="Shahar Soel">
    <meta charset="UTF-8">
    <link rel="icon" href="../themes/daux/img/favicon-blue.png" type="image/x-icon">
    <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>
    <!-- CSS -->
    <link href='../themes/daux/css/theme-blue.min.css' rel='stylesheet' type='text/css'>
            <!-- Tipue Search -->
        <link href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body class=" ">
    <div class="Columns content">
    <aside class="Columns__left Collapsible">
        <button type="button" class="Button Collapsible__trigger">
            <span class="Collapsible__trigger--bar"></span>
            <span class="Collapsible__trigger--bar"></span>
            <span class="Collapsible__trigger--bar"></span>
        </button>

        <a class="Brand" href="../index.html">Chevrotain</a>

    <div class="Search">
        <svg class="Search__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451 451">
            <path d="M447.05 428l-109.6-109.6c29.4-33.8 47.2-77.9 47.2-126.1C384.65 86.2 298.35 0 192.35 0 86.25 0 .05 86.3.05 192.3s86.3 192.3 192.3 192.3c48.2 0 92.3-17.8 126.1-47.2L428.05 447c2.6 2.6 6.1 4 9.5 4s6.9-1.3 9.5-4c5.2-5.2 5.2-13.8 0-19zM26.95 192.3c0-91.2 74.2-165.3 165.3-165.3 91.2 0 165.3 74.2 165.3 165.3s-74.1 165.4-165.3 165.4c-91.1 0-165.3-74.2-165.3-165.4z"/>
        </svg>
        <input type="search" id="tipue_search_input" class="Search__field" placeholder="Search..." autocomplete="on"
               results=25 autosave=text_search>
    </div>

        <div class="Collapsible__content">
            <!-- Navigation -->
            <ul class='Nav'><li class='Nav__item  has-children'><a href="../Tutorial/step1_lexing.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Tutorial</a><ul class='Nav'><li class='Nav__item '><a href="../Tutorial/step1_lexing.html">step1 lexing</a></li><li class='Nav__item '><a href="../Tutorial/step2_parsing.html">step2 parsing</a></li><li class='Nav__item '><a href="../Tutorial/step3_adding_actions_root.html">step3 adding actions root</a></li><li class='Nav__item '><a href="../Tutorial/step3a_adding_actions_visitor.html">step3a adding actions visitor</a></li><li class='Nav__item '><a href="../Tutorial/step3b_adding_actions_embedded.html">step3b adding actions embedded</a></li><li class='Nav__item '><a href="../Tutorial/step4_fault_tolerance.html">step4 fault tolerance</a></li></ul></li><li class='Nav__item Nav__item--open has-children'><a href="../Deep_Dive/concrete_syntax_tree.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Deep Dive</a><ul class='Nav'><li class='Nav__item '><a href="../Deep_Dive/concrete_syntax_tree.html">concrete syntax tree</a></li><li class='Nav__item '><a href="../Deep_Dive/custom_apis.html">custom apis</a></li><li class='Nav__item '><a href="../Deep_Dive/custom_token_patterns.html">custom token patterns</a></li><li class='Nav__item Nav__item--active'><a href="../Deep_Dive/syntactic_content_assist.html">syntactic content assist</a></li></ul></li><li class='Nav__item  has-children'><a href="../Building_Grammars/generating_syntax_diagrams.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Building Grammars</a><ul class='Nav'><li class='Nav__item '><a href="../Building_Grammars/generating_syntax_diagrams.html">generating syntax diagrams</a></li><li class='Nav__item '><a href="../Building_Grammars/resolving_grammar_errors.html">resolving grammar errors</a></li><li class='Nav__item '><a href="../Building_Grammars/resolving_lexer_errors.html">resolving lexer errors</a></li></ul></li><li class='Nav__item '><a href="../FAQ.html">FAQ</a></li><li class='Nav__item '><a href="../Roadmap.html">Roadmap</a></li></ul>

            <div class="Links">
                                    <hr/>
                                            <a href="http://sap.github.io/chevrotain/playground/" target="_blank">Online Playground</a>
                        <br />
                                            <a href="http://sap.github.io/chevrotain/performance/" target="_blank">Performance Benchmark</a>
                        <br />
                                            <a href="https://github.com/sap/chevrotain/issues" target="_blank">Help/Support/Bugs</a>
                        <br />
                                            <a href="https://github.com/sap/chevrotain" target="_blank">GitHub Repo</a>
                        <br />
                                    
                                    <div class="CodeToggler">
                        <hr/>
                                                    <a class="CodeToggler__button CodeToggler__button--main" href="#">Show Code Blocks Inline</a><br>
                                            </div>
                
                            </div>
        </div>
    </aside>
    <div class="Columns__right ">
        <div class="Columns__right__content">
            <div class="doc_content">
                <article class="Page">

    <div class="Page__header">
        <h1><a href="../Deep_Dive/concrete_syntax_tree.html">Deep Dive</a> <svg class="Page__header--separator" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 477.175 477.175"><path d="M360.73 229.075l-225.1-225.1c-5.3-5.3-13.8-5.3-19.1 0s-5.3 13.8 0 19.1l215.5 215.5-215.5 215.5c-5.3 5.3-5.3 13.8 0 19.1 2.6 2.6 6.1 4 9.5 4 3.4 0 6.9-1.3 9.5-4l225.1-225.1c5.3-5.2 5.3-13.8.1-19z"/></svg> <a href="../Deep_Dive/syntactic_content_assist.html">syntactic content assist</a></h1>
                <span style="float: left; font-size: 10px; color: gray;">
            Tuesday, February 20, 2018 3:02 PM        </span>
                        <span style="float: right; font-size: 10px; color: gray;">
            <a href="https://github.com/SAP/chevrotain/blob/master/docs/02_Deep_Dive/syntactic_content_assist.md" target="_blank">Edit on GitHub</a>
        </span>
            </div>


    <div class="s-content">
        <h2 id="page_Syntactic-Content-Assist">Syntactic Content Assist</h2>
<p>See: <a href="https://github.com/SAP/chevrotain/blob/master/examples/parser/content_assist/official_feature_content_assist.js" class="external"><strong>Runnable example</strong></a> for quick starting.</p>
<h3 id="page_Detailed-Docs">Detailed Docs:</h3>
<p>Chevrotain provides Syntactic Content assist Capabilities.
These can be accessed via the <a href="http://sap.github.io/chevrotain/documentation/2_0_2/classes/parser.html#computecontentassist" class="external"><strong>computeContentAssist</strong></a> method.</p>
<p>Note that this feature <strong>only</strong> provides syntactic suggestions (meaning next possible token types) <strong>not</strong> semantic suggestions.
It could be used as a building block in a semantic suggestions provider, but it cannot do this on &quot;its own&quot;.</p>
<p>Also note that this feature is implemented as a <strong>separate</strong> interpreted backtracking parser,
completely unrelated to the normal parsing flow except for using the same internal grammar representation.</p>
<p>This causes several important limitations:</p>
<ul>
<li>
<p><strong>Performance</strong>: The Content assist feature is about x10 times slower than the normal parsing flow.</p>
</li>
<li>
<p>No Embedded actions will be performed.</p>
</li>
<li>
<p>Error Recovery is unsupported</p>
</li>
<li>
<p>Gates / Predicates are unsupported.</p>
</li>
</ul>
<p>These limitations may seem daunting at first, but should not cause great problems in actual practice.
The following sections will discuss each limitation in details.</p>
<h3 id="page_Slow-Performance">Slow Performance.</h3>
<p>An order of magnitude slower performance may at first sound like a horrible thing.
Lets put this in perspective for relevant use cases:</p>
<ul>
<li>
<p>Being an order of magnitude slower also means approximately the same speed as Jison.</p>
<ul>
<li>Tested on Chrome 54, See: <a href="http://sap.github.io/chevrotain/performance/" class="external">performance benchmark</a>.</li>
</ul>
</li>
<li>
<p><strong>Smaller input Size 1</strong>: Content Assist is requested for an offset inside a text, this means that on average only half the text input
will have to be parsed. Suddenly the problem is halved...</p>
</li>
<li>
<p><strong>Smaller input size 2</strong>: Syntactic Content Assist is requested for a single text input(file), while standard parsing flow may need
to handle dozens or hundreds of inputs at once.</p>
</li>
<li>
<p><strong>Less work</strong>: The ~x10 performance difference was measured when comparing pure grammars without any embedded actions.
In a <strong>real world</strong> scenario the difference will be smaller as the base parser will have embedded actions
with their own runtime cost while the content assist parser will <strong>always</strong> remain a pure grammar.</p>
</li>
<li>
<p><strong>Smart beats fast</strong>: Content Assist is normally used in a code editor. A code editor should be by definition
<strong>incremental</strong> as it does not matter how smart the error recovery is or how fast the parser, re-parsing a whole
file for every single changed character will simply <strong>not scale</strong>, both from a performance perspective and from the requirement
of handling partially invalid inputs. What this means is that if a code editor is already (as it should be) incremental.
It could invoke the call to <strong>computeContentAssist</strong> on a subset of the input as well. This subset could easily
be <strong>several</strong> orders of magnitudes smaller, thus all performance concerns are resolved.</p>
<ul>
<li>
<p>Example: Imagine a 1,000 lines JavaScript file where a single 10 lines function is being edited and content assist
is requested inside that small function.</p>
<pre><code>     ```javascript

     // line 1
     // .
     // .
     // .
     // line 600
     function foo() {
     // content assist requested somewhere in this function
     }
     // line 610
     // .
     // .
     // .
     // line 1000

     ```
</code></pre>
<p>There is no need no re-parse the whole file, Instead only the text of that function should be sent
To <strong>computeContentAssist</strong> and the &quot;startRule&quot; should be &quot;functionDeclaration&quot;. Therefore only ~10 lines
of text will have to be re-parsed to provide syntactic content assist.
This is a 1/100 difference in input size which is <strong>two orders of magnitude</strong> smaller.</p>
</li>
</ul>
</li>
</ul>
<h3 id="page_No-support-for-Embedded-Actions-and-Error-Recovery">No support for Embedded Actions and Error Recovery.</h3>
<p>Once again, Content assist is often used in a code Editor's context.
Embedded actions will normally only output useful results for <strong>valid parts</strong> of the input.
Error recovery can help with invalid inputs by performing small automatic fixes to the input and more often by completely
skipping (re-syncing) parts of the input until a &quot;valid&quot; section is encountered.</p>
<p>The problem is that usually the code area where content assist is requested is also currently being <strong>heavily</strong> modified by the user
and is unlikely to able to be successfully parsed or automatically fixed, instead it will probably be skipped (re-synced) entirely.</p>
<p>What this means is that for input areas that are currently being edited (or even written from scratch) by the user
Embedded actions and error recovery are less useful anyhow. And if as described in the previous section an incremental approach
to using the content assist will also resolve the issue in which the content assist position follows a syntax error.</p>
<p>Example:</p>
<pre><code class="language-javascript">let three = // syntax error, missing expression
let five = 5
let six = 1 + // &lt;-- content assist requested after the '+'
return Math.max(five, six)

</code></pre>
<ol>
<li>
<p>The first and third statements are syntactically invalid.</p>
</li>
<li>
<p>Error recovery is likely to re-sync to the following statements instead of resolving this with single token insertion / deletion.</p>
</li>
<li>
<p>Therefore the results of embedded actions on these statements will not be useful.</p>
</li>
<li>
<p>Content assist is request in the third statement after the &quot;+&quot; operator.</p>
</li>
<li>
<p>If we try to send the whole text to request content assist suggestions until the offset after the &quot;+&quot; operator
No suggestions will be found due to the syntax error on the first statement.</p>
</li>
<li>
<p>However if we only send the text of the third statement (&quot;let six = 1 + &quot;) content assist will work successfully.</p>
</li>
</ol>
<h3 id="page_No-support-for-Gates-Predicates">No support for Gates / Predicates.</h3>
<p>Gates / Predicates act is limiters of the available grammar. These constructs are not often used in grammars
which reduces the severity of this limitation.</p>
<p>But more importantly this <strong>does not mean that grammars using Gates cannot use the content assist functionality</strong>.
Rather that in some <strong>pathological edge cases</strong> the suggestions may not be completely valid.</p>
<p>In details: the content assist parser is a &quot;backtracking&quot; Parser,
which means it will try <strong>all</strong> the paths until it finds a valid one.
It disregards the max token lookahead constraints of the base Chevrotain parser.
Therefor for a grammar path that has been disabled by a Gate / Predicate to be offered as content assist suggestion:
Not only does the fixed tokens lookahead have to match at the Gate's position.
The <strong>whole input</strong> following the Gate's position must <strong>also</strong> match.
This is a much stronger condition (K tokens vs dozens/hundreds/infinity) thus making this issue a very minor one.</p>
    </div>

        <nav>
        <ul class="Pager">
            <li class=Pager--prev><a href="../Deep_Dive/custom_token_patterns.html">Previous</a></li>            <li class=Pager--next><a href="../Building_Grammars/generating_syntax_diagrams.html">Next</a></li>        </ul>
    </nav>
    </article>

            </div>
        </div>
    </div>
</div>

    
    <!-- jQuery -->
    <script src="../themes/daux/js/jquery-1.11.3.min.js"></script>

    <!-- hightlight.js -->
    <script src="../themes/daux/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- JS -->
    
    <script src="../themes/daux/js/daux.js"></script>

            <!-- Tipue Search -->
        <script type="text/javascript" src="../tipuesearch/tipuesearch.js"></script>

        <script>
            window.onunload = function(){}; // force $(document).ready to be called on back/forward navigation in firefox
            $(function() {
                tipuesearch({
                    'base_url': '../'
                });
            });
        </script>
    
</body>
</html>
